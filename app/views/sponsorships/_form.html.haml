- conference = sponsorship.conference
- desc = conference.form_description_for_locale
= form_with(model: sponsorship, url: user_conference_sponsorship_path(conference), local: true, class: 'sponsorships_form') do |form|

  - if sponsorship.errors.any?
    - I18n.with_options(scope: %i(errors template)) do |lo|
      .alert.alert-danger
        %p= lo.t :header, count: sponsorship.errors.count, model: sponsorship.class.name
        %ul
          - sponsorship.errors.full_messages.each do |message|
            %li= message

  %section.py-2
    .form-group
      %h2= t('.header', name: conference.name)
      = desc.head_html&.html_safe

  %section.py-2
    .form-group
      %h3= t('.contact')

    = form.fields_for :contact do |contact_form|
      .form-group
        = contact_form.label :email
        = contact_form.email_field :email, class: 'form-control', required: true

      .form-group
        = contact_form.label :address
        = contact_form.text_field :address, class: 'form-control', required: true

      .form-group
        = contact_form.label :organization
        = contact_form.text_field :organization, class: 'form-control', required: true

      .form-group
        = contact_form.label :unit
        = contact_form.text_field :unit, class: 'form-control', placeholder: t('.optional')

      .form-group
        = contact_form.label :name
        = contact_form.text_field :name, class: 'form-control', required: true

  %section.py-2.sponsorships_form_billing_contact
    .form-group
      %h3= t('.billing')

    = form.fields_for :alternate_billing_contact do |contact_form|
      .form-group
        .form-check
          = contact_form.check_box :_keep, class: 'form-check-input'
          = contact_form.label :_keep, t('.specify_alternate_billing_contact'), class: 'form-check-label'

      %fieldset
        .form-group
          = contact_form.label :email
          = contact_form.email_field :email, class: 'form-control', required: true

        .form-group
          = contact_form.label :address
          = contact_form.text_field :address, class: 'form-control', required: true

        .form-group
          = contact_form.label :organization
          = contact_form.text_field :organization, class: 'form-control', required: true

        .form-group
          = contact_form.label :unit
          = contact_form.text_field :unit, class: 'form-control', placeholder: t('.optional')

        .form-group
          = contact_form.label :name
          = contact_form.text_field :name, class: 'form-control', required: true

    = form.fields_for :billing_request do |request_form|
      .form-group
        = request_form.label :body
        = request_form.text_area :body, class: 'form-control', aria: {describedby: 'billing_request_help'}
        %small.form-text#billing_request_help= t('.billing_request_help')

  %section.py-2
    .form-group
      %h3= t('.plan')
      = desc.plan_help_html&.html_safe

    .form-group.sponsorships_form_plans
      %h5= t('.plans')
      - conference.plans.each do |plan|
        .form-check
          %label.form-check-label
            = form.radio_button :plan_id, plan.id, checked: plan.id == @sponsorship.plan_id, class: 'form-check-input', disabled: !plan.available? && plan.id != @sponsorship.plan_id, data: {booth: plan.booth_eligible? ? '1' : '0', words_limit_help: t('.plan_explanation.words_limit', count: plan.words_limit)}
            = plan.name
            %small<
              #{plan.price_text}
              , #{t('.plan_explanation.guests', count: plan.number_of_guests)}
              - if plan.booth_eligible?
                , #{t('.plan_explanation.booth', count: plan.booth_size)}
              - if plan.talkable?
                , #{t('.plan_explanation.talk')}
            - unless plan.available?
              %small.badge.badge-danger= t('.plan_sold_out')
      .form-check
        %label.form-check-label
          = form.radio_button :plan_id, '', checked: @sponsorship.plan_id == nil && (@sponsorship.persisted? || @sponsorship.errors.any?), class: 'form-check-input', data: {other: '1'}
          Other

    = form.fields_for :customization_request do |request_form|
      .form-group
        = request_form.label :body
        = request_form.text_area :body, class: 'form-control sponsorships_form_customization_request'

  %section.py-2
    .form-group
      %h3= t('.booth')
      = desc.booth_help_html&.html_safe

    .form-group.sponsorships_form_booth_request
      .form-check
        = form.check_box :booth_requested, class: 'form-check-input'
        = form.label :booth_requested, class: 'form-check-label'
      %small.d-none.sponsorships_form_booth_request_uneligible.form-text.text-small.text-info= t('.booth_uneligible_plan_selected', plans: conference.plans.select(&:booth_eligible?).map(&:name).join(', '))

  %section.py-2
    .form-group
      %h3= t('.information')

      %p= t('.information_help')

    .form-group
      = form.label :name
      = form.text_field :name, class: 'form-control', required: true

    .form-group
      = form.label :url
      = form.text_field :url, class: 'form-control', required: true, placeholder: 'https://...'

    .form-group
      = form.label :profile
      = form.text_area :profile, class: 'form-control', required: true
      %small.sponsorships_form_profile_help.form-text

  %section.py-2
    .form-group
      %h3= t('.logo')

      %p= t('.logo_help')

    .form-group.sponsorships_form_asset_file{data: {session_endpoint: user_conference_sponsorship_asset_file_path, session_endpoint_method: sponsorship.asset_file&.persisted? ? 'PUT': 'POST'}}
      = form.hidden_field :asset_file_id
      .sponsorships_form_asset_file_form (Loading)

  %section.py-2
    .form-group
      %h3= t('.note')

      %p= t('.others_help')

    = form.fields_for :note do |request_form|
      .form-group
        = request_form.label :body
        = request_form.text_area :body, class: 'form-control'

  %section.py-2
    .form-group
      %h3= t('.policies')

      %p= desc.policy_help_html&.html_safe

      .form-check
        = form.check_box :policy_agreement, class: 'form-check-input', required: true
        = form.label :policy_agreement, "", class: 'form-check-label'

    .form-group
      = form.submit t('.submit'), class: 'btn btn-primary', data: {disable_with: false}

    .alert.alert-danger.submit_error.d-none
